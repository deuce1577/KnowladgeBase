# –ì–∏–±–∫–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è

## –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
**–ì–∏–±–∫–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è** (Flexible Indexing) - —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º VectorBT PRO, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –±–µ–∑ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª–Ω—ã—Ö –º–∞—Å—Å–∏–≤–æ–≤ –≤ –ø–∞–º—è—Ç–∏.

## –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### üéØ Broadcasting –Ω–∞ –ª–µ—Ç—É
VectorBT —É–º–µ–µ—Ç "–ø—Ä–æ–µ—Ü–∏—Ä–æ–≤–∞—Ç—å" (—ç–∫—Å—Ç—Ä–∞–ø–æ–ª–∏—Ä–æ–≤–∞—Ç—å) –º–µ–Ω—å—à–∏–µ –º–∞—Å—Å–∏–≤—ã –Ω–∞ –±–æ–ª—å—à–∏–µ —Ñ–æ—Ä–º—ã:

```python
# –í–º–µ—Å—Ç–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ —Ä–∞–∑–º–µ—Ä–æ–º (1000, 50)
# –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å —Å–∫–∞–ª—è—Ä –∏–ª–∏ –º–∞—Å—Å–∏–≤ –º–µ–Ω—å—à–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
size = 100  # –ë—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω –∫–æ –≤—Å–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞–º
# –∏–ª–∏
size = [100, 200, 150]  # –ë—É–¥–µ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω
```

### üìä –§–æ—Ä–º–∞ –¥–∞–Ω–Ω—ã—Ö
–û—Å–Ω–æ–≤–Ω–∞—è —Ñ–æ—Ä–º–∞: `(timestamps √ó assets + parameter combinations)`

**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è**:
```
     Asset1  Asset2  Asset3  ...
t1   [data]  [data]  [data]
t2   [data]  [data]  [data]  
t3   [data]  [data]  [data]
...
```

### üß© –ö—É–±–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å
–î–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è: –≤—Å–µ –º–∞—Å—Å–∏–≤—ã –Ω–∞–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞, –æ–±—Ä–∞–∑—É—è –∫—É–±, –≥–¥–µ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–µ–∫—Ç–æ—Ä–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—Ä–¥–µ—Ä–µ.

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### üíæ –≠–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏
- **–ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è** –¥–∞–Ω–Ω—ã—Ö
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π memory footprint**
- **–†–∞–±–æ—Ç–∞ —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏** –±–µ–∑ –≤—ã—Ö–æ–¥–∞ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã RAM

### ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏** –º–∞—Å—Å–∏–≤–æ–≤
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** –∫—ç—à–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
- **–í–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** Numba

### üîß –£–¥–æ–±—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **–ù–µ–ø–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–ø–æ–ª–Ω—è–µ—Ç—Å—è
- **–ì–∏–±–∫–æ—Å—Ç—å** –≤ –∑–∞–¥–∞–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- **–ò–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**

## –¢–∏–ø—ã –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏

### 1. Per Timestamp (–ü–æ –≤—Ä–µ–º–µ–Ω–∏)
```python
# –û–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–æ–≤ –≤ –∫–∞–∂–¥—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏
size_per_timestamp = [100, 150, 200, ...]  # len = n_timestamps
```

### 2. Per Asset (–ü–æ –∞–∫—Ç–∏–≤—É)
```python
# –û–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫—Ç–∏–≤–∞ –Ω–∞ –≤—Å–µ –≤—Ä–µ–º—è
size_per_asset = [100, 200, 300]  # len = n_assets
```

### 3. Per Matrix (–î–ª—è –≤—Å–µ–π –º–∞—Ç—Ä–∏—Ü—ã)
```python
# –û–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è –≤—Å–µ–π —Å–∏–º—É–ª—è—Ü–∏–∏
size_global = 100  # scalar
```

### 4. Per Element (–ü–æ —ç–ª–µ–º–µ–Ω—Ç—É)
```python
# –ü–æ–ª–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
size_full = np.array([[100, 200, 300],   # t1: asset1, asset2, asset3
                      [150, 250, 350],   # t2: asset1, asset2, asset3
                      ...])              # shape: (n_timestamps, n_assets)
```

## –†–æ—Ç–∞—Ü–∏–æ–Ω–Ω–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è

### üîÑ Rotational Indexing
–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:

```python
# –ï—Å–ª–∏ —É –Ω–∞—Å 1000 –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫, –Ω–æ —Ç–æ–ª—å–∫–æ 3 –∑–Ω–∞—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞
sizes = [100, 200, 300]
# VectorBT –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω–∏—Ç:
# t1: 100, t2: 200, t3: 300, t4: 100, t5: 200, t6: 300, ...
```

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

### –ù–µ–ø–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
```python
# –í–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã 1000x50
portfolio = vbt.Portfolio.from_orders(
    data,
    size=100,           # –°–∫–∞–ª—è—Ä –¥–ª—è –≤—Å–µ—Ö
    price=data.close,   # –ü–æ–ª–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ —Ü–µ–Ω
    fees=0.001         # –°–∫–∞–ª—è—Ä –∫–æ–º–∏—Å—Å–∏–∏
)
```

### –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
```python
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ –ø–æ–∑–∏—Ü–∏–π –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –æ–≥—Ä–æ–º–Ω—ã—Ö –º–∞—Å—Å–∏–≤–æ–≤
sizes = [50, 100, 150, 200, 250]
portfolio = vbt.Portfolio.from_orders(
    data,
    size=sizes,  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—Å—è –∫–æ –≤—Å–µ–º –∫–æ–º–±–∏–Ω–∞—Ü–∏—è–º
    price=data.close
)
```

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏
- [[Numba –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è]]
- [[–ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ —Å–∏–º—É–ª—è—Ü–∏—è - –∫–æ–Ω—Ü–µ–ø—Ü–∏—è]]
- [[–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö]]

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
- [[–ö–∞–∫ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã]]
- [[–ö–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏]]

#vectorbt #flexible-indexing #broadcasting #memory-optimization #performance #data-structures

---
**–ò—Å—Ç–æ—á–Ω–∏–∫**: [VectorBT PRO From Orders](https://vectorbt.pro/pvt_7bb7e815/documentation/portfolio/from-orders/#summary)  
**–ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**: Broadcasting, Projection, Rotational indexing